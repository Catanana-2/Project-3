<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Boodschappenlijst - FreshChoice</title>
<link rel="stylesheet" href="static/style.css">
<style>
    body {
        font-family: 'Inter', sans-serif;
        background-color: #f5f5f5;
        margin: 0;
        padding: 0;
    }

    header {
        background-color: #6FB23E;
        padding: 20px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        margin-bottom: 20px;
        text-align: center;
    }

    main {
        display: flex;
        flex-wrap: wrap;
        max-width: 1200px;
        margin: 0 auto;
        gap: 20px;
        padding: 0 20px 40px;
    }

    section.products {
        flex: 2;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
    }

    section.products .product-card {
        background-color: #fff;
        border-radius: 10px;
        padding: 15px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }

    section.products .product-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0,0,0,0.12);
    }

    section.products input[type="checkbox"] {
        margin-bottom: 10px;
    }

    aside.cart {
        flex: 1;
        background-color: #fff;
        padding: 20px;
        border-radius: 10px;
        min-width: 250px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        height: fit-content;
    }

    aside.cart h2 {
        margin-bottom: 15px;
        font-size: 1.25rem;
        color: #333;
    }

    aside.cart ul {
        list-style: none;
        padding: 0;
    }

    aside.cart ul li {
        padding: 8px 0;
        border-bottom: 1px solid #eee;
        color: #555;
    }

    aside.cart ul li:last-child {
        border-bottom: none;
    }

    @media (max-width: 768px) {
        main {
            flex-direction: column;
        }
    }

    .header-winkelwagen {
        display: flex;
        flex-direction: column;
    }

    .home {
        display: flex;
        justify-content: flex-start;
        background-color: white;
        color: black;
        padding: 10px;
        width: 70px;
        border-radius: 8px;
        font-weight: bold;
        transition: background-color 0.3s;
        text-align: center;
    }

    .streep {
        text-decoration: none;
    }

    .home:hover {
        background-color: darkgray;
    }

    .suggested-header {
    text-align: center;
    width: 100%;
    }

    .suggested-items {
        display: flex;
        justify-content: center;
        flex-direction: row;
        gap: 30px;
    }

    .category {
        display: flex;
        flex-direction: column;
    }
</style>
</head>

<body>

<div class="header-winkelwagen">
<header>
    <div class="header-winkelwagen"></div>
    <div class="home">
        <a class="streep" href="index.html">Home</a>
    </div>

    <h1 class="logo">FreshChoice</h1>
    <p>Beheer je boodschappenlijst online</p>
</header>
</div>

<div>
    <h2 class="suggested-header">Voorgestelde producten</h2>
     <section class="suggested-items" id="suggested-items">

     </section>
</div>
<main>
    <section class="products" id="products">
        <!-- <div class="product-card">
            <input type="checkbox" id="item1" data-name="Appels" data-id="6">
            <label for="item1">Appels</label>
        </div>

        <div class="product-card">
            <input type="checkbox" id="item2" data-name="Bananen" data-id="2">
            <label for="item2">Bananen</label>
        </div>

        <div class="product-card">
            <input type="checkbox" id="item3" data-name="Brood" data-id="3">
            <label for="item3">Brood</label>
        </div>

        <div class="product-card">
            <input type="checkbox" id="item4" data-name="Melk" data-id="1">
            <label for="item4">Melk</label>
        </div>

        <div class="product-card">
            <input type="checkbox" id="item5" data-name="Eieren" data-id="8">
            <label for="item5">Eieren</label>
        </div>

        <div class="product-card">
            <input type="checkbox" id="item6" data-name="Kaas" data-id="9">
            <label for="item6">Kaas</label>
        </div> -->
    </section>

    <!-- Winkelmandje -->
    <aside class="cart">
        <h2>Winkelmandje</h2>
        <ul id="cartList">
            <li class="placeholder">Nog geen items geselecteerd</li>
        </ul>
    </aside>
</main>

<script>
const cartList = document.getElementById('cartList');
const productsContainer = document.getElementById('products');

/* Updates the cart based on all current checkboxes */
function updateCart() {
    const checkboxes = document.querySelectorAll('#products input[type="checkbox"]');

    const selected = Array.from(checkboxes)
        .filter(cb => cb.checked)
        .map(cb => cb.dataset.name);

    cartList.innerHTML = '';

    if (selected.length === 0) {
        cartList.innerHTML = '<li class="placeholder">Nog geen items geselecteerd</li>';
        return;
    }

    selected.forEach(item => {
        const li = document.createElement('li');
        li.textContent = item;
        cartList.appendChild(li);
    });
}

/* Handles checkbox changes for static & dynamic items */
productsContainer.addEventListener('change', function(e) {
    if (e.target.matches('input[type="checkbox"]')) {
        const cb = e.target;

        updateCart();

        const ProductID = cb.dataset.id;
        const Checked = cb.checked ? 1 : 0;

        fetch("update_shoppinglist.php", {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: `ProductID=${encodeURIComponent(ProductID)}&Checked=${Checked}`
        })
        .then(r => r.text())
        .then(t => console.log("Server response:", t))
        .catch(err => console.error(err));
    }
});

fetch('SuggestedItems.php')
    .then(r => r.json())
    .then(data => {
        const list = document.getElementById('suggested-items');

        Object.keys(data).forEach(category => {
            const div = document.createElement('div');
            div.className = 'category'
            const heading = document.createElement('h3');
            heading.textContent = category;
            list.appendChild(div);
            div.appendChild(heading);

            data[category].forEach(product => {
                const li = document.createElement('p');
                li.textContent = `${product.ProductNaam} – €${product.Prijs}`;
                div.appendChild(li);
                
            });
        });
    });

fetch('Products.php')
    .then(r => r.json())
    .then(data => {
        data.forEach((product, index) => {
            const div = document.createElement('div');
            div.className = 'product-card';

            const input = document.createElement('input');
            input.type = 'checkbox';
            input.id = `item_dynamic_${index}`;
            input.dataset.name = product.ProductNaam;
            input.dataset.id = product.ProductID; 

            const label = document.createElement('label');
            label.htmlFor = input.id;
            label.textContent = product.ProductNaam;

            div.appendChild(input);
            div.appendChild(label);
            productsContainer.appendChild(div);
        });
    });
</script>

</body>
</html>
